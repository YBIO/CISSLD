nohup: ignoring input
===================Train Info===========================
  task : 15-1
  step : 1
  Device: cuda
  opts :  Namespace(KD_loss_type='KD_loss', KD_outlogits=False, amp=True, batch_size=12, bn_freeze=True, ckpt=None, contrastive_learning=False, crop_size=513, crop_val=False, curr_itrs=0, curr_step=1, cutmix=False, cutout=False, data_ratio=0.25, data_root='/home/yb/dataset/VOC/PascalVOC12/VOCdevkit/VOC2012', dataset='voc', feature_decoupling=True, freeze=True, gpu_id='2,3', lamb=1.0, loss_type='bce_loss', lr=0.01, lr_policy='poly', mem_size=0, mixup=False, model='deeplabv3_resnet101', num_classes=[1, 1, 15, 1], output_stride=16, overlap=True, print_interval=10, prototype_matching=False, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, step_size=10000, task='15-1', test_only=False, train_epoch=30, unknown=True, use_KD_class_weight=False, use_KD_layer_weight=True, val_batch_size=4, val_interval=200, w_transfer=True, weight_decay=0.0001)
==============================================
... weight transfer
Model restored from checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_0_overlap.pth
>>>num_all_file for step-train training: 487
>>>num_LD_file for step-train training: 122
>>>num_file for val: 85
Dataset: voc, Train set: 122, Val set: 85, Test set: 1449
... train epoch : 30 , iterations : 300 , val_interval : 100
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_1_overlap.pth
[15-1 / step 1] Epoch 5, Itrs 50/300, Loss=0.660758, CL_loss=0.000000, KD_loss_ret=   nan, Time=628.81 , LR=0.00848666
[15-1 / step 1] Epoch 10, Itrs 100/300, Loss=0.554824, CL_loss=0.000000, KD_loss_ret=   nan, Time=624.64 , LR=0.00694253
validation...

Overall Acc: 0.823477
Mean Acc: 0.078577
FreqW Acc: 0.781587
Mean IoU: 0.072130
Class IoU/Acc:
\background: 0.8176 (miou) , 0.8568 (acc) 
\aeroplane: 0.0000 (miou) , 0.0000 (acc) 
\bicycle: 0.0000 (miou) , 0.0000 (acc) 
\bird: 0.0000 (miou) , 0.0000 (acc) 
\boat: 0.0000 (miou) , 0.0000 (acc) 
\bottle: 0.0000 (miou) , 0.0000 (acc) 
\bus: 0.0000 (miou) , 0.0000 (acc) 
\car: 0.0000 (miou) , 0.0000 (acc) 
\cat: 0.0000 (miou) , 0.0000 (acc) 
\chair: 0.0000 (miou) , 0.0000 (acc) 
\cow: 0.0000 (miou) , 0.0000 (acc) 
\diningtable: 0.0000 (miou) , 0.0000 (acc) 
\dog: 0.0000 (miou) , 0.0000 (acc) 
\horse: 0.0000 (miou) , 0.0000 (acc) 
\motorbike: 0.0000 (miou) , 0.0000 (acc) 
\person: 0.0000 (miou) , 0.0000 (acc) 
\pottedplant: 0.4086 (miou) , 0.4790 (acc) 

curr_val_score : 0.4086
... save best ckpt :  0.40857401831862816
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_1_overlap.pth
[15-1 / step 1] Epoch 15, Itrs 150/300, Loss=0.555211, CL_loss=0.000000, KD_loss_ret=   nan, Time=631.48 , LR=0.00535887
[15-1 / step 1] Epoch 20, Itrs 200/300, Loss=0.571586, CL_loss=0.000000, KD_loss_ret=   nan, Time=629.73 , LR=0.00372041
validation...

Overall Acc: 0.828276
Mean Acc: 0.077937
FreqW Acc: 0.786590
Mean IoU: 0.072576
Class IoU/Acc:
\background: 0.8229 (miou) , 0.8638 (acc) 
\aeroplane: 0.0000 (miou) , 0.0000 (acc) 
\bicycle: 0.0000 (miou) , 0.0000 (acc) 
\bird: 0.0000 (miou) , 0.0000 (acc) 
\boat: 0.0000 (miou) , 0.0000 (acc) 
\bottle: 0.0000 (miou) , 0.0000 (acc) 
\bus: 0.0000 (miou) , 0.0000 (acc) 
\car: 0.0000 (miou) , 0.0000 (acc) 
\cat: 0.0000 (miou) , 0.0000 (acc) 
\chair: 0.0000 (miou) , 0.0000 (acc) 
\cow: 0.0000 (miou) , 0.0000 (acc) 
\diningtable: 0.0000 (miou) , 0.0000 (acc) 
\dog: 0.0000 (miou) , 0.0000 (acc) 
\horse: 0.0000 (miou) , 0.0000 (acc) 
\motorbike: 0.0000 (miou) , 0.0000 (acc) 
\person: 0.0000 (miou) , 0.0000 (acc) 
\pottedplant: 0.4109 (miou) , 0.4612 (acc) 

curr_val_score : 0.4109
... save best ckpt :  0.41089370436148653
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_1_overlap.pth
[15-1 / step 1] Epoch 25, Itrs 250/300, Loss=0.596289, CL_loss=0.000000, KD_loss_ret=   nan, Time=627.81 , LR=0.00199372
[15-1 / step 1] Epoch 30, Itrs 300/300, Loss=0.599970, CL_loss=0.000000, KD_loss_ret=   nan, Time=637.52 , LR=0.00000100
validation...

Overall Acc: 0.827416
Mean Acc: 0.078999
FreqW Acc: 0.786749
Mean IoU: 0.073299
Class IoU/Acc:
\background: 0.8218 (miou) , 0.8608 (acc) 
\aeroplane: 0.0000 (miou) , 0.0000 (acc) 
\bicycle: 0.0000 (miou) , 0.0000 (acc) 
\bird: 0.0000 (miou) , 0.0000 (acc) 
\boat: 0.0000 (miou) , 0.0000 (acc) 
\bottle: 0.0000 (miou) , 0.0000 (acc) 
\bus: 0.0000 (miou) , 0.0000 (acc) 
\car: 0.0000 (miou) , 0.0000 (acc) 
\cat: 0.0000 (miou) , 0.0000 (acc) 
\chair: 0.0000 (miou) , 0.0000 (acc) 
\cow: 0.0000 (miou) , 0.0000 (acc) 
\diningtable: 0.0000 (miou) , 0.0000 (acc) 
\dog: 0.0000 (miou) , 0.0000 (acc) 
\horse: 0.0000 (miou) , 0.0000 (acc) 
\motorbike: 0.0000 (miou) , 0.0000 (acc) 
\person: 0.0000 (miou) , 0.0000 (acc) 
\pottedplant: 0.4243 (miou) , 0.4822 (acc) 

curr_val_score : 0.4243
... save best ckpt :  0.42431099969962865
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_1_overlap.pth
... Training Done
... Testing Best Model

Overall Acc: 0.940132
Mean Acc: 0.868032
FreqW Acc: 0.898841
Mean IoU: 0.723141
Class IoU/Acc:
\background: 0.9326 (miou) , 0.9550 (acc) 
\aeroplane: 0.7843 (miou) , 0.9508 (acc) 
\bicycle: 0.3792 (miou) , 0.9050 (acc) 
\bird: 0.8563 (miou) , 0.9477 (acc) 
\boat: 0.6442 (miou) , 0.9065 (acc) 
\bottle: 0.7420 (miou) , 0.9310 (acc) 
\bus: 0.9232 (miou) , 0.9640 (acc) 
\car: 0.8118 (miou) , 0.9274 (acc) 
\cat: 0.9112 (miou) , 0.9626 (acc) 
\chair: 0.3643 (miou) , 0.4920 (acc) 
\cow: 0.8536 (miou) , 0.9485 (acc) 
\diningtable: 0.5763 (miou) , 0.6652 (acc) 
\dog: 0.8680 (miou) , 0.9487 (acc) 
\horse: 0.8270 (miou) , 0.9225 (acc) 
\motorbike: 0.8084 (miou) , 0.9491 (acc) 
\person: 0.8297 (miou) , 0.8984 (acc) 
\pottedplant: 0.1811 (miou) , 0.4822 (acc) 

...from 0 to 15 : best/test_before_mIoU : 0.757018
...from 16 to 16 best/test_after_mIoU : 0.181105
...from 0 to 15 : best/test_before_acc : 0.892146
...from 16 to 16 best/test_after_acc : 0.482206
===================Train Info===========================
  task : 15-1
  step : 2
  Device: cuda
  opts :  Namespace(KD_loss_type='KD_loss', KD_outlogits=False, amp=True, batch_size=12, bn_freeze=True, ckpt='checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_0_overlap.pth', contrastive_learning=False, crop_size=513, crop_val=False, curr_itrs=0, curr_step=2, cutmix=False, cutout=False, data_ratio=0.25, data_root='/home/yb/dataset/VOC/PascalVOC12/VOCdevkit/VOC2012', dataset='voc', feature_decoupling=True, freeze=True, gpu_id='2,3', lamb=1.0, loss_type='bce_loss', lr=0.01, lr_policy='poly', mem_size=0, mixup=False, model='deeplabv3_resnet101', num_classes=[1, 1, 15, 1, 1], output_stride=16, overlap=True, print_interval=10, prototype_matching=False, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, step_size=10000, task='15-1', test_only=False, train_epoch=30, unknown=True, use_KD_class_weight=False, use_KD_layer_weight=True, val_batch_size=1, val_interval=200, w_transfer=True, weight_decay=0.0001)
==============================================
... weight transfer
Model restored from checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_1_overlap.pth
>>>num_all_file for step-train training: 299
>>>num_LD_file for step-train training: 75
>>>num_file for val: 57
Dataset: voc, Train set: 75, Val set: 57, Test set: 1449
... train epoch : 30 , iterations : 180 , val_interval : 100
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_2_overlap.pth
[15-1 / step 2] Epoch 9, Itrs 50/180, Loss=0.378185, CL_loss=0.000000, KD_loss_ret=   nan, Time=1031.35 , LR=0.00746112
[15-1 / step 2] Epoch 17, Itrs 100/180, Loss=0.391838, CL_loss=0.000000, KD_loss_ret=   nan, Time=777.45 , LR=0.00481987
validation...

Overall Acc: 0.940220
Mean Acc: 0.101706
FreqW Acc: 0.914196
Mean IoU: 0.095734
Class IoU/Acc:
\background: 0.9470 (miou) , 0.9557 (acc) 
\aeroplane: 0.0000 (miou) , 0.0000 (acc) 
\bicycle: 0.0000 (miou) , 0.0000 (acc) 
\bird: 0.0000 (miou) , 0.0000 (acc) 
\boat: 0.0000 (miou) , 0.0000 (acc) 
\bottle: 0.0000 (miou) , 0.0000 (acc) 
\bus: 0.0000 (miou) , 0.0000 (acc) 
\car: 0.0000 (miou) , 0.0000 (acc) 
\cat: 0.0000 (miou) , 0.0000 (acc) 
\chair: 0.0000 (miou) , 0.0000 (acc) 
\cow: 0.0000 (miou) , 0.0000 (acc) 
\diningtable: 0.0000 (miou) , 0.0000 (acc) 
\dog: 0.0000 (miou) , 0.0000 (acc) 
\horse: 0.0000 (miou) , 0.0000 (acc) 
\motorbike: 0.0000 (miou) , 0.0000 (acc) 
\person: 0.0000 (miou) , 0.0000 (acc) 
\pottedplant: 0.0000 (miou) , 0.0000 (acc) 
\sheep: 0.7762 (miou) , 0.8750 (acc) 

curr_val_score : 0.7762
... save best ckpt :  0.7762214620409056
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_2_overlap.pth
[15-1 / step 2] Epoch 25, Itrs 150/180, Loss=0.526154, CL_loss=0.000000, KD_loss_ret=   nan, Time=696.85 , LR=0.00199372
... Training Done
... Testing Best Model

Overall Acc: 0.929141
Mean Acc: 0.860576
FreqW Acc: 0.886289
Mean IoU: 0.694455
Class IoU/Acc:
\background: 0.9241 (miou) , 0.9436 (acc) 
\aeroplane: 0.7816 (miou) , 0.9493 (acc) 
\bicycle: 0.3773 (miou) , 0.9052 (acc) 
\bird: 0.8562 (miou) , 0.9381 (acc) 
\boat: 0.6327 (miou) , 0.9049 (acc) 
\bottle: 0.7420 (miou) , 0.9310 (acc) 
\bus: 0.9238 (miou) , 0.9671 (acc) 
\car: 0.8106 (miou) , 0.9262 (acc) 
\cat: 0.9040 (miou) , 0.9465 (acc) 
\chair: 0.3664 (miou) , 0.5001 (acc) 
\cow: 0.7786 (miou) , 0.8561 (acc) 
\diningtable: 0.5756 (miou) , 0.6647 (acc) 
\dog: 0.8726 (miou) , 0.9418 (acc) 
\horse: 0.8098 (miou) , 0.9128 (acc) 
\motorbike: 0.8081 (miou) , 0.9490 (acc) 
\person: 0.8292 (miou) , 0.8984 (acc) 
\pottedplant: 0.1756 (miou) , 0.4803 (acc) 
\sheep: 0.3320 (miou) , 0.8750 (acc) 

...from 0 to 15 : best/test_before_mIoU : 0.749536
...from 16 to 17 best/test_after_mIoU : 0.253803
...from 0 to 15 : best/test_before_acc : 0.883441
...from 16 to 17 best/test_after_acc : 0.677662
===================Train Info===========================
  task : 15-1
  step : 3
  Device: cuda
  opts :  Namespace(KD_loss_type='KD_loss', KD_outlogits=False, amp=True, batch_size=12, bn_freeze=True, ckpt='checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_1_overlap.pth', contrastive_learning=False, crop_size=513, crop_val=False, curr_itrs=0, curr_step=3, cutmix=False, cutout=False, data_ratio=0.25, data_root='/home/yb/dataset/VOC/PascalVOC12/VOCdevkit/VOC2012', dataset='voc', feature_decoupling=True, freeze=True, gpu_id='2,3', lamb=1.0, loss_type='bce_loss', lr=0.01, lr_policy='poly', mem_size=0, mixup=False, model='deeplabv3_resnet101', num_classes=[1, 1, 15, 1, 1, 1], output_stride=16, overlap=True, print_interval=10, prototype_matching=False, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, step_size=10000, task='15-1', test_only=False, train_epoch=30, unknown=True, use_KD_class_weight=False, use_KD_layer_weight=True, val_batch_size=1, val_interval=200, w_transfer=True, weight_decay=0.0001)
==============================================
... weight transfer
Model restored from checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_2_overlap.pth
>>>num_all_file for step-train training: 491
>>>num_LD_file for step-train training: 123
>>>num_file for val: 90
Dataset: voc, Train set: 123, Val set: 90, Test set: 1449
... train epoch : 30 , iterations : 300 , val_interval : 100
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_3_overlap.pth
[15-1 / step 3] Epoch 5, Itrs 50/300, Loss=1.024750, CL_loss=0.000000, KD_loss_ret=   nan, Time=640.14 , LR=0.00848666
[15-1 / step 3] Epoch 10, Itrs 100/300, Loss=0.979842, CL_loss=0.000000, KD_loss_ret=   nan, Time=652.90 , LR=0.00694253
validation...

Overall Acc: 0.725564
Mean Acc: 0.067131
FreqW Acc: 0.642502
Mean IoU: 0.058588
Class IoU/Acc:
\background: 0.7130 (miou) , 0.7976 (acc) 
\aeroplane: 0.0000 (miou) , 0.0000 (acc) 
\bicycle: 0.0000 (miou) , 0.0000 (acc) 
\bird: 0.0000 (miou) , 0.0000 (acc) 
\boat: 0.0000 (miou) , 0.0000 (acc) 
\bottle: 0.0000 (miou) , 0.0000 (acc) 
\bus: 0.0000 (miou) , 0.0000 (acc) 
\car: 0.0000 (miou) , 0.0000 (acc) 
\cat: 0.0000 (miou) , 0.0000 (acc) 
\chair: 0.0000 (miou) , 0.0000 (acc) 
\cow: 0.0000 (miou) , 0.0000 (acc) 
\diningtable: 0.0000 (miou) , 0.0000 (acc) 
\dog: 0.0000 (miou) , 0.0000 (acc) 
\horse: 0.0000 (miou) , 0.0000 (acc) 
\motorbike: 0.0000 (miou) , 0.0000 (acc) 
\person: 0.0000 (miou) , 0.0000 (acc) 
\pottedplant: 0.0000 (miou) , 0.0000 (acc) 
\sheep: 0.0000 (miou) , 0.0000 (acc) 
\sofa: 0.4002 (miou) , 0.4778 (acc) 

curr_val_score : 0.4002
... save best ckpt :  0.40016049533066417
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_3_overlap.pth
[15-1 / step 3] Epoch 15, Itrs 150/300, Loss=0.873528, CL_loss=0.000000, KD_loss_ret=   nan, Time=653.34 , LR=0.00535887
[15-1 / step 3] Epoch 20, Itrs 200/300, Loss=0.978512, CL_loss=0.000000, KD_loss_ret=   nan, Time=657.98 , LR=0.00372041
validation...

Overall Acc: 0.729234
Mean Acc: 0.067275
FreqW Acc: 0.649200
Mean IoU: 0.059292
Class IoU/Acc:
\background: 0.7197 (miou) , 0.8032 (acc) 
\aeroplane: 0.0000 (miou) , 0.0000 (acc) 
\bicycle: 0.0000 (miou) , 0.0000 (acc) 
\bird: 0.0000 (miou) , 0.0000 (acc) 
\boat: 0.0000 (miou) , 0.0000 (acc) 
\bottle: 0.0000 (miou) , 0.0000 (acc) 
\bus: 0.0000 (miou) , 0.0000 (acc) 
\car: 0.0000 (miou) , 0.0000 (acc) 
\cat: 0.0000 (miou) , 0.0000 (acc) 
\chair: 0.0000 (miou) , 0.0000 (acc) 
\cow: 0.0000 (miou) , 0.0000 (acc) 
\diningtable: 0.0000 (miou) , 0.0000 (acc) 
\dog: 0.0000 (miou) , 0.0000 (acc) 
\horse: 0.0000 (miou) , 0.0000 (acc) 
\motorbike: 0.0000 (miou) , 0.0000 (acc) 
\person: 0.0000 (miou) , 0.0000 (acc) 
\pottedplant: 0.0000 (miou) , 0.0000 (acc) 
\sheep: 0.0000 (miou) , 0.0000 (acc) 
\sofa: 0.4068 (miou) , 0.4750 (acc) 

curr_val_score : 0.4068
... save best ckpt :  0.40684020261495146
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_3_overlap.pth
[15-1 / step 3] Epoch 25, Itrs 250/300, Loss=0.962763, CL_loss=0.000000, KD_loss_ret=   nan, Time=660.46 , LR=0.00199372
[15-1 / step 3] Epoch 30, Itrs 300/300, Loss=0.893049, CL_loss=0.000000, KD_loss_ret=   nan, Time=648.80 , LR=0.00000100
validation...

Overall Acc: 0.736621
Mean Acc: 0.069354
FreqW Acc: 0.657550
Mean IoU: 0.061015
Class IoU/Acc:
\background: 0.7215 (miou) , 0.8004 (acc) 
\aeroplane: 0.0000 (miou) , 0.0000 (acc) 
\bicycle: 0.0000 (miou) , 0.0000 (acc) 
\bird: 0.0000 (miou) , 0.0000 (acc) 
\boat: 0.0000 (miou) , 0.0000 (acc) 
\bottle: 0.0000 (miou) , 0.0000 (acc) 
\bus: 0.0000 (miou) , 0.0000 (acc) 
\car: 0.0000 (miou) , 0.0000 (acc) 
\cat: 0.0000 (miou) , 0.0000 (acc) 
\chair: 0.0000 (miou) , 0.0000 (acc) 
\cow: 0.0000 (miou) , 0.0000 (acc) 
\diningtable: 0.0000 (miou) , 0.0000 (acc) 
\dog: 0.0000 (miou) , 0.0000 (acc) 
\horse: 0.0000 (miou) , 0.0000 (acc) 
\motorbike: 0.0000 (miou) , 0.0000 (acc) 
\person: 0.0000 (miou) , 0.0000 (acc) 
\pottedplant: 0.0000 (miou) , 0.0000 (acc) 
\sheep: 0.0000 (miou) , 0.0000 (acc) 
\sofa: 0.4378 (miou) , 0.5173 (acc) 

curr_val_score : 0.4378
... save best ckpt :  0.4377953629296019
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_3_overlap.pth
... Training Done
... Testing Best Model

Overall Acc: 0.913026
Mean Acc: 0.837398
FreqW Acc: 0.864760
Mean IoU: 0.668927
Class IoU/Acc:
\background: 0.9085 (miou) , 0.9312 (acc) 
\aeroplane: 0.7818 (miou) , 0.9494 (acc) 
\bicycle: 0.3782 (miou) , 0.9009 (acc) 
\bird: 0.8566 (miou) , 0.9376 (acc) 
\boat: 0.6318 (miou) , 0.9022 (acc) 
\bottle: 0.7429 (miou) , 0.9292 (acc) 
\bus: 0.9247 (miou) , 0.9689 (acc) 
\car: 0.8098 (miou) , 0.9280 (acc) 
\cat: 0.9030 (miou) , 0.9439 (acc) 
\chair: 0.3189 (miou) , 0.4427 (acc) 
\cow: 0.7786 (miou) , 0.8562 (acc) 
\diningtable: 0.5742 (miou) , 0.6660 (acc) 
\dog: 0.8714 (miou) , 0.9386 (acc) 
\horse: 0.8089 (miou) , 0.9146 (acc) 
\motorbike: 0.8059 (miou) , 0.9511 (acc) 
\person: 0.8265 (miou) , 0.8965 (acc) 
\pottedplant: 0.2068 (miou) , 0.4630 (acc) 
\sheep: 0.3465 (miou) , 0.8734 (acc) 
\sofa: 0.2348 (miou) , 0.5173 (acc) 

...from 0 to 15 : best/test_before_mIoU : 0.745098
...from 16 to 18 best/test_after_mIoU : 0.262687
...from 0 to 15 : best/test_before_acc : 0.878556
...from 16 to 18 best/test_after_acc : 0.617890
===================Train Info===========================
  task : 15-1
  step : 4
  Device: cuda
  opts :  Namespace(KD_loss_type='KD_loss', KD_outlogits=False, amp=True, batch_size=12, bn_freeze=True, ckpt='checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_2_overlap.pth', contrastive_learning=False, crop_size=513, crop_val=False, curr_itrs=0, curr_step=4, cutmix=False, cutout=False, data_ratio=0.25, data_root='/home/yb/dataset/VOC/PascalVOC12/VOCdevkit/VOC2012', dataset='voc', feature_decoupling=True, freeze=True, gpu_id='2,3', lamb=1.0, loss_type='bce_loss', lr=0.01, lr_policy='poly', mem_size=0, mixup=False, model='deeplabv3_resnet101', num_classes=[1, 1, 15, 1, 1, 1, 1], output_stride=16, overlap=True, print_interval=10, prototype_matching=False, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, step_size=10000, task='15-1', test_only=False, train_epoch=30, unknown=True, use_KD_class_weight=False, use_KD_layer_weight=True, val_batch_size=1, val_interval=200, w_transfer=True, weight_decay=0.0001)
==============================================
... weight transfer
Model restored from checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_3_overlap.pth
>>>num_all_file for step-train training: 500
>>>num_LD_file for step-train training: 125
>>>num_file for val: 84
Dataset: voc, Train set: 125, Val set: 84, Test set: 1449
... train epoch : 30 , iterations : 300 , val_interval : 100
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_4_overlap.pth
[15-1 / step 4] Epoch 5, Itrs 50/300, Loss=1.158969, CL_loss=0.000000, KD_loss_ret=   nan, Time=656.35 , LR=0.00848666
[15-1 / step 4] Epoch 10, Itrs 100/300, Loss=0.915624, CL_loss=0.000000, KD_loss_ret=   nan, Time=663.55 , LR=0.00694253
validation...

Overall Acc: 0.908135
Mean Acc: 0.089665
FreqW Acc: 0.848742
Mean IoU: 0.082337
Class IoU/Acc:
\background: 0.8806 (miou) , 0.9225 (acc) 
\aeroplane: 0.0000 (miou) , 0.0000 (acc) 
\bicycle: 0.0000 (miou) , 0.0000 (acc) 
\bird: 0.0000 (miou) , 0.0000 (acc) 
\boat: 0.0000 (miou) , 0.0000 (acc) 
\bottle: 0.0000 (miou) , 0.0000 (acc) 
\bus: 0.0000 (miou) , 0.0000 (acc) 
\car: 0.0000 (miou) , 0.0000 (acc) 
\cat: 0.0000 (miou) , 0.0000 (acc) 
\chair: 0.0000 (miou) , 0.0000 (acc) 
\cow: 0.0000 (miou) , 0.0000 (acc) 
\diningtable: 0.0000 (miou) , 0.0000 (acc) 
\dog: 0.0000 (miou) , 0.0000 (acc) 
\horse: 0.0000 (miou) , 0.0000 (acc) 
\motorbike: 0.0000 (miou) , 0.0000 (acc) 
\person: 0.0000 (miou) , 0.0000 (acc) 
\pottedplant: 0.0000 (miou) , 0.0000 (acc) 
\sheep: 0.0000 (miou) , 0.0000 (acc) 
\sofa: 0.0000 (miou) , 0.0000 (acc) 
\train: 0.7662 (miou) , 0.8708 (acc) 

curr_val_score : 0.7662
... save best ckpt :  0.7661587350194515
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_4_overlap.pth
[15-1 / step 4] Epoch 15, Itrs 150/300, Loss=0.996962, CL_loss=0.000000, KD_loss_ret=   nan, Time=668.71 , LR=0.00535887
[15-1 / step 4] Epoch 20, Itrs 200/300, Loss=1.007558, CL_loss=0.000000, KD_loss_ret=   nan, Time=665.95 , LR=0.00372041
validation...

Overall Acc: 0.913760
Mean Acc: 0.089898
FreqW Acc: 0.858779
Mean IoU: 0.083497
Class IoU/Acc:
\background: 0.8887 (miou) , 0.9323 (acc) 
\aeroplane: 0.0000 (miou) , 0.0000 (acc) 
\bicycle: 0.0000 (miou) , 0.0000 (acc) 
\bird: 0.0000 (miou) , 0.0000 (acc) 
\boat: 0.0000 (miou) , 0.0000 (acc) 
\bottle: 0.0000 (miou) , 0.0000 (acc) 
\bus: 0.0000 (miou) , 0.0000 (acc) 
\car: 0.0000 (miou) , 0.0000 (acc) 
\cat: 0.0000 (miou) , 0.0000 (acc) 
\chair: 0.0000 (miou) , 0.0000 (acc) 
\cow: 0.0000 (miou) , 0.0000 (acc) 
\diningtable: 0.0000 (miou) , 0.0000 (acc) 
\dog: 0.0000 (miou) , 0.0000 (acc) 
\horse: 0.0000 (miou) , 0.0000 (acc) 
\motorbike: 0.0000 (miou) , 0.0000 (acc) 
\person: 0.0000 (miou) , 0.0000 (acc) 
\pottedplant: 0.0000 (miou) , 0.0000 (acc) 
\sheep: 0.0000 (miou) , 0.0000 (acc) 
\sofa: 0.0000 (miou) , 0.0000 (acc) 
\train: 0.7813 (miou) , 0.8657 (acc) 

curr_val_score : 0.7813
... save best ckpt :  0.7812829611286025
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_4_overlap.pth
[15-1 / step 4] Epoch 25, Itrs 250/300, Loss=1.008511, CL_loss=0.000000, KD_loss_ret=   nan, Time=665.50 , LR=0.00199372
[15-1 / step 4] Epoch 30, Itrs 300/300, Loss=1.039905, CL_loss=0.000000, KD_loss_ret=   nan, Time=670.74 , LR=0.00000100
validation...

Overall Acc: 0.914941
Mean Acc: 0.090045
FreqW Acc: 0.859850
Mean IoU: 0.083623
Class IoU/Acc:
\background: 0.8895 (miou) , 0.9331 (acc) 
\aeroplane: 0.0000 (miou) , 0.0000 (acc) 
\bicycle: 0.0000 (miou) , 0.0000 (acc) 
\bird: 0.0000 (miou) , 0.0000 (acc) 
\boat: 0.0000 (miou) , 0.0000 (acc) 
\bottle: 0.0000 (miou) , 0.0000 (acc) 
\bus: 0.0000 (miou) , 0.0000 (acc) 
\car: 0.0000 (miou) , 0.0000 (acc) 
\cat: 0.0000 (miou) , 0.0000 (acc) 
\chair: 0.0000 (miou) , 0.0000 (acc) 
\cow: 0.0000 (miou) , 0.0000 (acc) 
\diningtable: 0.0000 (miou) , 0.0000 (acc) 
\dog: 0.0000 (miou) , 0.0000 (acc) 
\horse: 0.0000 (miou) , 0.0000 (acc) 
\motorbike: 0.0000 (miou) , 0.0000 (acc) 
\person: 0.0000 (miou) , 0.0000 (acc) 
\pottedplant: 0.0000 (miou) , 0.0000 (acc) 
\sheep: 0.0000 (miou) , 0.0000 (acc) 
\sofa: 0.0000 (miou) , 0.0000 (acc) 
\train: 0.7830 (miou) , 0.8678 (acc) 

curr_val_score : 0.7830
... save best ckpt :  0.7829812354115737
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_4_overlap.pth
... Training Done
... Testing Best Model

Overall Acc: 0.898995
Mean Acc: 0.835179
FreqW Acc: 0.845277
Mean IoU: 0.657054
Class IoU/Acc:
\background: 0.8923 (miou) , 0.9143 (acc) 
\aeroplane: 0.7883 (miou) , 0.9408 (acc) 
\bicycle: 0.3827 (miou) , 0.9003 (acc) 
\bird: 0.8558 (miou) , 0.9390 (acc) 
\boat: 0.6309 (miou) , 0.8931 (acc) 
\bottle: 0.7421 (miou) , 0.9287 (acc) 
\bus: 0.8927 (miou) , 0.9291 (acc) 
\car: 0.8148 (miou) , 0.9251 (acc) 
\cat: 0.9026 (miou) , 0.9441 (acc) 
\chair: 0.3204 (miou) , 0.4476 (acc) 
\cow: 0.7786 (miou) , 0.8562 (acc) 
\diningtable: 0.5799 (miou) , 0.6767 (acc) 
\dog: 0.8712 (miou) , 0.9386 (acc) 
\horse: 0.8074 (miou) , 0.9101 (acc) 
\motorbike: 0.8174 (miou) , 0.9484 (acc) 
\person: 0.8259 (miou) , 0.8985 (acc) 
\pottedplant: 0.2115 (miou) , 0.4642 (acc) 
\sheep: 0.4039 (miou) , 0.8758 (acc) 
\sofa: 0.2350 (miou) , 0.5051 (acc) 
\train: 0.3877 (miou) , 0.8678 (acc) 

...from 0 to 15 : best/test_before_mIoU : 0.743934
...from 16 to 19 best/test_after_mIoU : 0.309533
...from 0 to 15 : best/test_before_acc : 0.874417
...from 16 to 19 best/test_after_acc : 0.678225
===================Train Info===========================
  task : 15-1
  step : 5
  Device: cuda
  opts :  Namespace(KD_loss_type='KD_loss', KD_outlogits=False, amp=True, batch_size=12, bn_freeze=True, ckpt='checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_3_overlap.pth', contrastive_learning=False, crop_size=513, crop_val=False, curr_itrs=0, curr_step=5, cutmix=False, cutout=False, data_ratio=0.25, data_root='/home/yb/dataset/VOC/PascalVOC12/VOCdevkit/VOC2012', dataset='voc', feature_decoupling=True, freeze=True, gpu_id='2,3', lamb=1.0, loss_type='bce_loss', lr=0.01, lr_policy='poly', mem_size=0, mixup=False, model='deeplabv3_resnet101', num_classes=[1, 1, 15, 1, 1, 1, 1, 1], output_stride=16, overlap=True, print_interval=10, prototype_matching=False, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, step_size=10000, task='15-1', test_only=False, train_epoch=30, unknown=True, use_KD_class_weight=False, use_KD_layer_weight=True, val_batch_size=1, val_interval=200, w_transfer=True, weight_decay=0.0001)
==============================================
... weight transfer
Model restored from checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_4_overlap.pth
>>>num_all_file for step-train training: 548
>>>num_LD_file for step-train training: 137
>>>num_file for val: 74
Dataset: voc, Train set: 137, Val set: 74, Test set: 1449
... train epoch : 30 , iterations : 330 , val_interval : 100
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_5_overlap.pth
[15-1 / step 5] Epoch 5, Itrs 50/330, Loss=1.227679, CL_loss=0.000000, KD_loss_ret=   nan, Time=743.75 , LR=0.00862541
[15-1 / step 5] Epoch 10, Itrs 100/330, Loss=0.843116, CL_loss=0.000000, KD_loss_ret=   nan, Time=1585.11 , LR=0.00722591
validation...

Overall Acc: 0.738174
Mean Acc: 0.055774
FreqW Acc: 0.720667
Mean IoU: 0.053889
Class IoU/Acc:
\background: 0.7787 (miou) , 0.7954 (acc) 
\aeroplane: 0.0000 (miou) , 0.0000 (acc) 
\bicycle: 0.0000 (miou) , 0.0000 (acc) 
\bird: 0.0000 (miou) , 0.0000 (acc) 
\boat: 0.0000 (miou) , 0.0000 (acc) 
\bottle: 0.0000 (miou) , 0.0000 (acc) 
\bus: 0.0000 (miou) , 0.0000 (acc) 
\car: 0.0000 (miou) , 0.0000 (acc) 
\cat: 0.0000 (miou) , 0.0000 (acc) 
\chair: 0.0000 (miou) , 0.0000 (acc) 
\cow: 0.0000 (miou) , 0.0000 (acc) 
\diningtable: 0.0000 (miou) , 0.0000 (acc) 
\dog: 0.0000 (miou) , 0.0000 (acc) 
\horse: 0.0000 (miou) , 0.0000 (acc) 
\motorbike: 0.0000 (miou) , 0.0000 (acc) 
\person: 0.0000 (miou) , 0.0000 (acc) 
\pottedplant: 0.0000 (miou) , 0.0000 (acc) 
\sheep: 0.0000 (miou) , 0.0000 (acc) 
\sofa: 0.0000 (miou) , 0.0000 (acc) 
\train: 0.0000 (miou) , 0.0000 (acc) 
\tvmonitor: 0.3530 (miou) , 0.3759 (acc) 

curr_val_score : 0.3530
... save best ckpt :  0.3529589147958708
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_5_overlap.pth
[15-1 / step 5] Epoch 14, Itrs 150/330, Loss=1.091344, CL_loss=0.000000, KD_loss_ret=   nan, Time=715.26 , LR=0.00579539
[15-1 / step 5] Epoch 19, Itrs 200/330, Loss=1.561779, CL_loss=0.000000, KD_loss_ret=   nan, Time=1083.03 , LR=0.00432401
validation...

Overall Acc: 0.748319
Mean Acc: 0.058347
FreqW Acc: 0.730818
Mean IoU: 0.056494
Class IoU/Acc:
\background: 0.7824 (miou) , 0.7992 (acc) 
\aeroplane: 0.0000 (miou) , 0.0000 (acc) 
\bicycle: 0.0000 (miou) , 0.0000 (acc) 
\bird: 0.0000 (miou) , 0.0000 (acc) 
\boat: 0.0000 (miou) , 0.0000 (acc) 
\bottle: 0.0000 (miou) , 0.0000 (acc) 
\bus: 0.0000 (miou) , 0.0000 (acc) 
\car: 0.0000 (miou) , 0.0000 (acc) 
\cat: 0.0000 (miou) , 0.0000 (acc) 
\chair: 0.0000 (miou) , 0.0000 (acc) 
\cow: 0.0000 (miou) , 0.0000 (acc) 
\diningtable: 0.0000 (miou) , 0.0000 (acc) 
\dog: 0.0000 (miou) , 0.0000 (acc) 
\horse: 0.0000 (miou) , 0.0000 (acc) 
\motorbike: 0.0000 (miou) , 0.0000 (acc) 
\person: 0.0000 (miou) , 0.0000 (acc) 
\pottedplant: 0.0000 (miou) , 0.0000 (acc) 
\sheep: 0.0000 (miou) , 0.0000 (acc) 
\sofa: 0.0000 (miou) , 0.0000 (acc) 
\train: 0.0000 (miou) , 0.0000 (acc) 
\tvmonitor: 0.4040 (miou) , 0.4261 (acc) 

curr_val_score : 0.4040
... save best ckpt :  0.403972818906472
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_5_overlap.pth
[15-1 / step 5] Epoch 23, Itrs 250/330, Loss=1.233452, CL_loss=0.000000, KD_loss_ret=   nan, Time=694.67 , LR=0.00279331
[15-1 / step 5] Epoch 28, Itrs 300/330, Loss=1.277061, CL_loss=0.000000, KD_loss_ret=   nan, Time=923.72 , LR=0.00115544
validation...

Overall Acc: 0.758493
Mean Acc: 0.061947
FreqW Acc: 0.739669
Mean IoU: 0.059513
Class IoU/Acc:
\background: 0.7827 (miou) , 0.7990 (acc) 
\aeroplane: 0.0000 (miou) , 0.0000 (acc) 
\bicycle: 0.0000 (miou) , 0.0000 (acc) 
\bird: 0.0000 (miou) , 0.0000 (acc) 
\boat: 0.0000 (miou) , 0.0000 (acc) 
\bottle: 0.0000 (miou) , 0.0000 (acc) 
\bus: 0.0000 (miou) , 0.0000 (acc) 
\car: 0.0000 (miou) , 0.0000 (acc) 
\cat: 0.0000 (miou) , 0.0000 (acc) 
\chair: 0.0000 (miou) , 0.0000 (acc) 
\cow: 0.0000 (miou) , 0.0000 (acc) 
\diningtable: 0.0000 (miou) , 0.0000 (acc) 
\dog: 0.0000 (miou) , 0.0000 (acc) 
\horse: 0.0000 (miou) , 0.0000 (acc) 
\motorbike: 0.0000 (miou) , 0.0000 (acc) 
\person: 0.0000 (miou) , 0.0000 (acc) 
\pottedplant: 0.0000 (miou) , 0.0000 (acc) 
\sheep: 0.0000 (miou) , 0.0000 (acc) 
\sofa: 0.0000 (miou) , 0.0000 (acc) 
\train: 0.0000 (miou) , 0.0000 (acc) 
\tvmonitor: 0.4671 (miou) , 0.5019 (acc) 

curr_val_score : 0.4671
... save best ckpt :  0.46708198185160166
Model saved as checkpoints/limitdata/deeplabv3_resnet101_voc_15-1_step_5_overlap.pth
... Training Done
... Testing Best Model

Overall Acc: 0.895967
Mean Acc: 0.815694
FreqW Acc: 0.839944
Mean IoU: 0.641337
Class IoU/Acc:
\background: 0.8902 (miou) , 0.9154 (acc) 
\aeroplane: 0.7885 (miou) , 0.9405 (acc) 
\bicycle: 0.3841 (miou) , 0.8910 (acc) 
\bird: 0.8558 (miou) , 0.9384 (acc) 
\boat: 0.6356 (miou) , 0.8908 (acc) 
\bottle: 0.7437 (miou) , 0.9285 (acc) 
\bus: 0.8926 (miou) , 0.9292 (acc) 
\car: 0.8142 (miou) , 0.9245 (acc) 
\cat: 0.9027 (miou) , 0.9440 (acc) 
\chair: 0.3169 (miou) , 0.4365 (acc) 
\cow: 0.7784 (miou) , 0.8562 (acc) 
\diningtable: 0.5773 (miou) , 0.6726 (acc) 
\dog: 0.8716 (miou) , 0.9378 (acc) 
\horse: 0.8076 (miou) , 0.9096 (acc) 
\motorbike: 0.8186 (miou) , 0.9475 (acc) 
\person: 0.8262 (miou) , 0.8937 (acc) 
\pottedplant: 0.2117 (miou) , 0.4560 (acc) 
\sheep: 0.4138 (miou) , 0.8750 (acc) 
\sofa: 0.2392 (miou) , 0.4710 (acc) 
\train: 0.3783 (miou) , 0.8695 (acc) 
\tvmonitor: 0.3210 (miou) , 0.5019 (acc) 

...from 0 to 15 : best/test_before_mIoU : 0.744007
...from 16 to 20 best/test_after_mIoU : 0.312793
...from 0 to 15 : best/test_before_acc : 0.872260
...from 16 to 20 best/test_after_acc : 0.634682
